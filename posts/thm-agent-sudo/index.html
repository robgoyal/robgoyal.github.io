<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Agent Sudo (Try Hack Me)" /><meta name="author" content="Robin Goyal" /><meta property="og:locale" content="en" /><meta name="description" content="I am currently in the process of completing these boxes on Try Hack Me again in an effort to document my experience, reinforce my knowledge of the topics, and improve my ability to concisely communicate the pentest lifecycle." /><meta property="og:description" content="I am currently in the process of completing these boxes on Try Hack Me again in an effort to document my experience, reinforce my knowledge of the topics, and improve my ability to concisely communicate the pentest lifecycle." /><link rel="canonical" href="https://robgoyal.github.io/posts/thm-agent-sudo/" /><meta property="og:url" content="https://robgoyal.github.io/posts/thm-agent-sudo/" /><meta property="og:site_name" content="Robin Goyal" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-26T19:00:00-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Agent Sudo (Try Hack Me)" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Robin Goyal"},"dateModified":"2022-01-24T21:23:51-05:00","datePublished":"2021-08-26T19:00:00-04:00","description":"I am currently in the process of completing these boxes on Try Hack Me again in an effort to document my experience, reinforce my knowledge of the topics, and improve my ability to concisely communicate the pentest lifecycle.","headline":"Agent Sudo (Try Hack Me)","mainEntityOfPage":{"@type":"WebPage","@id":"https://robgoyal.github.io/posts/thm-agent-sudo/"},"url":"https://robgoyal.github.io/posts/thm-agent-sudo/"}</script><title>Agent Sudo (Try Hack Me) | Robin Goyal</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Robin Goyal"><meta name="application-name" content="Robin Goyal"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profilepic.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Robin Goyal</a></div><div class="site-subtitle font-italic">Software Developer & Cybersecurity Enthusiast</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="/resume.pdf" aria-label="resume" class="order-3" > <i class="fas fa-file-alt"></i> </a> <a href="https://github.com/robgoyal" aria-label="github" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['robin.goyal.swd','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/robingoyal" aria-label="linkedin" class="order-6" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Agent Sudo (Try Hack Me)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Agent Sudo (Try Hack Me)</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Robin Goyal </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Aug 26, 2021, 7:00 PM -0400" >Aug 26, 2021<i class="unloaded">2021-08-26T19:00:00-04:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Jan 24, 2022, 9:23 PM -0500" >Jan 24, 2022<i class="unloaded">2022-01-24T21:23:51-05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1201 words">6 min read</span></div></div><div class="post-content"> <img data-proofer-ignore data-src="https://tryhackme-images.s3.amazonaws.com/room-icons/aedc6b66c222e15ff740c282a0c3f44e.png" class="preview-img" alt="Preview Image" ><p>I am currently in the process of completing these boxes on Try Hack Me again in an effort to document my experience, reinforce my knowledge of the topics, and improve my ability to concisely communicate the pentest lifecycle.</p><p>Note: The target IP address may change throughout the writeup as I complete the room over a period of time.</p><h2 id="scenario">Scenario</h2><p><strong>Title</strong>: Agent Sudo</p><p><strong>Link</strong>: https://tryhackme.com/room/agentsudoctf</p><p><strong>Description</strong>: You found a secret server located under the deep sea. Your task is to hack inside the server and reveal the truth.</p><p><strong>Free/Subsciber</strong>: Free</p><p><strong>Difficulty</strong>: Easy</p><h2 id="enumeration">Enumeration</h2><p>First things first, let’s start off with an nmap scan.</p><p><img data-proofer-ignore data-src="/assets/img/posts/thm-agent-sudo/nmap.jpg" alt="nmap results" /></p><p>The target is an Ubuntu OS from information gained in the service version information for SSH and the Apache web server.</p><p>There are three open ports:</p><ul><li>21 (FTP)<li>22 (SSH)<li>80 (HTTP)</ul><h3 id="ftp">FTP</h3><p>The FTP service does not allow anonymous authentication so we may not be able to do much unless we have potential usernames and passwords.</p><h3 id="ssh">SSH</h3><p>No banner to grab so let’s move on to the HTTP service.</p><h3 id="http">HTTP</h3><p><img data-proofer-ignore data-src="/assets/img/posts/thm-agent-sudo/landing-page.jpg" alt="landing page" /></p><p>The landing page contains a clue on how we are able to access the site. The user-agent string might be some letter from the alphabet potentially including the word agent.</p><h4 id="burpsuite-intruder">Burpsuite Intruder</h4><p>Let’s generate a list and use Burpsuite’s Intruder feature to see if any of the user-agent strings provide access to the website!</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">string</span>

<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="s">"useragents.txt"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_uppercase</span><span class="p">:</span>
        <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">letter</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="s">"Agent "</span> <span class="o">+</span> <span class="n">letter</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
</pre></table></code></div></div><p>The above code generated a list of the format:</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>A
Agent A
B
Agent B
...
...
</pre></table></code></div></div><p>With the payload position set for the user-agent in the Intruder attack, we’ll load the generated list as potential payloads and launch the attack.</p><p>With the attack results, the payload with value “C” has a differing payload length size compared to the rest of the requests.</p><p><img data-proofer-ignore data-src="/assets/img/posts/thm-agent-sudo/burp-attack.jpg" alt="burp suite attack" /></p><p>Right click on the request that stands out, scroll down to “Show response in browser”, copy the URL, and open it in the browser. Burp will execute the exact request so you don’t have to manually modify the request yourself.</p><p><img data-proofer-ignore data-src="/assets/img/posts/thm-agent-sudo/agent-chris.jpg" alt="agent chris landing" /></p><p>There’s a few pieces of interesting information on the landing page:</p><ul><li>There is a third agent, J<li>Agent C’s name is chris<li>chris has a weak password</ul><h3 id="ftp-with-credentials">FTP with Credentials</h3><p>Attempting to brute force both the SSH service and FTP service, Hydra returned a password for Chris on the FTP service with a password of crystal.</p><p><img data-proofer-ignore data-src="/assets/img/posts/thm-agent-sudo/hydra.jpg" alt="ftp creds" /></p><p>FTP credentials: <code class="language-plaintext highlighter-rouge">chris:crystal</code></p><p><img data-proofer-ignore data-src="/assets/img/posts/thm-agent-sudo/ftp.jpg" alt="ftp listing" /></p><p>There are two image files and a text file. The contents of the text file To_agentJ.txt:</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>Dear agent J,

All these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn't be a problem for you.

From,
Agent C
</pre></table></code></div></div><p>So there is hidden data within the other two images that we might have to extract.</p><h2 id="initial-foothold">Initial Foothold</h2><h3 id="steganography">Steganography</h3><p>For the first image, cutie.png, let’s use the stegextract tool since it’s a PNG file. The usual tool that I use, steghide, doesn’t support PNG files.</p><p><img data-proofer-ignore data-src="/assets/img/posts/thm-agent-sudo/extracted.jpg" alt="cutie.png extracted" /></p><p>So we found a ZIP file that can only be extracted using the 7z command. However, the zip file requires a password. Fortunately, we can brute force this using John the Ripper by converting the zip file into a hash through the zip2john tool.</p><p><img data-proofer-ignore data-src="/assets/img/posts/thm-agent-sudo/extracted-crack.jpg" alt="cutie.png zip cracked" /></p><p>Success! The password for the zip file is <code class="language-plaintext highlighter-rouge">alien</code>. Within the zip file, there is a text file, To_agentR.txt, with the content</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>Agent C,

We need to send the picture to 'QXJlYTUx' as soon as possible!

By,
Agent R
</pre></table></code></div></div><p>That string looks like it is base64 encoded.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">echo </span>QXJlYTUx | <span class="nb">base64</span> <span class="nt">-d</span>
Area51
</pre></table></code></div></div><p>Great! Let’s move onto the second image, cutie-alien.jpg.</p><p>Since this is a JPEG image, we can use the steghide series of tools to determine if there is embedded data or not.</p><p><img data-proofer-ignore data-src="/assets/img/posts/thm-agent-sudo/steghide-info.jpg" alt="jpeg steghide info" /></p><p>The steghide tool prompted us for a password. Instinctively trying out Area51 as the password, the tool informed us that there is a message.txt file hidden in the image! Let’s extract it using</p><p><code class="language-plaintext highlighter-rouge">steghide extract -sf cute-alien.jpg</code></p><p>The contents of message.txt is</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>Hi james,

Glad you find this message. Your login password is hackerrules!

Don't ask me why the password look cheesy, ask agent R who set this password for you.

Your buddy,
chris
</pre></table></code></div></div><p>Looks like we are able to log into the server using the credentials <code class="language-plaintext highlighter-rouge">james:hackerrules!</code>.</p><p>Once authenticated to the SSH server, we find the flag in the home directory for james as user_flag.txt</p><p>User Flag: <code class="language-plaintext highlighter-rouge">b03d975e8c92a7c04146cfa7a5a313c7</code></p><h2 id="privilege-escalation">Privilege Escalation</h2><p>Let’s check the sudo privileges of james.</p><p><img data-proofer-ignore data-src="/assets/img/posts/thm-agent-sudo/sudo-privs.jpg" alt="sudo privs" /></p><p>The version of this sudo program is 1.8.21p2 which is susceptible to a vulnerability. The vulnerability focuses on the configuration of the user’s sudo privileges (ALL, !root) where the sudo program doesn’t check for the existence of thespecified user id and executes the non-existing id as sudo <sup id="fnref:sudo-exploit" role="doc-noteref"><a href="#fn:sudo-exploit" class="footnote" rel="footnote">1</a></sup>.</p><p>The command <code class="language-plaintext highlighter-rouge">sudo -u#-1 /bin/bash</code> will escalate you to the root privileges.</p><p><img data-proofer-ignore data-src="/assets/img/posts/thm-agent-sudo/root-flag.jpg" alt="root flag" /></p><p>Success! And the root flag was available at /root/root.txt.</p><p>Root Flag: <code class="language-plaintext highlighter-rouge">b53a02f55b57d4439e3341834d70c062</code></p><h2 id="reflection">Reflection</h2><p>This room was heavily focused on a CTF style which is fine but also took a while to kind of understand how to proceed through the different stages.</p><p>However, I learned a lot about extracting data hidden in PNG and JPEG images, brute forcing SSH and FTP services, and a privilege escalation vector that is focused on binaries that are not updated!</p><h3 id="killchain-summary">Killchain Summary</h3><ol><li>Retrieve Agent R’s note for Chris by brute forcing the user-agents on the web application.<li>Brute force the FTP service for the username chris knowing that he has a weak password.<li>Extract trailing ZIP file hidden in the PNG file.<li>Use zip2john and JTR with rockyou.txt to crack the password for the ZIP file.<li>Base64 decode the codeword in the ZIP file.<li>Use the decoded codeword as the password to the embedded data in the JPG file.<li>Authenticate to the SSH service with the credentials found in the embedded data.<li>Escalate privileges using <code class="language-plaintext highlighter-rouge">sudo -u#-1 /bin/bash</code></ol><h3 id="misconfigurations">Misconfigurations</h3><ol><li>The codenames for the Agents should be more obscure than just the letters of the alphabet.<li>Password policies should not allow weak or common words as passwords.<li>Embedded data within images is not a secure method for transmitting information.<li>System should be updated to remove the sudo privilege escalation vulnerability.</ol><h3 id="summary-of-exploits">Summary of Exploits</h3><h4 id="privilege-escalation-1">Privilege Escalation</h4><p>Specifically related to CVE-2019-14287, if the user’s privileges are configured with <code class="language-plaintext highlighter-rouge">(ALL, !root) /bin/bash</code> and the SUDO version is prior to 1.8.28, privileges can be escalated by:</p><p><code class="language-plaintext highlighter-rouge">sudo -u#-1 /bin/bash</code></p><p>This allows users with sudo privileges to run commands as root even if the specification states that you can run as ALL users except root so long as the ALL keyword is specified <sup id="fnref:sudo-exploit:1" role="doc-noteref"><a href="#fn:sudo-exploit" class="footnote" rel="footnote">1</a></sup>.</p><h3 id="things-i-learned">Things I Learned</h3><h4 id="steganography-1">Steganography</h4><p>Extract trailing data from a PNG file.</p><p><code class="language-plaintext highlighter-rouge">stegextract cutie.png</code></p><p>Bruteforce password cracking for a JPG file.</p><p><code class="language-plaintext highlighter-rouge">stegseek cutie-alien.jpg /usr/share/wordlists/rockyou.txt</code></p><h4 id="zip-cracking">Zip Cracking</h4><p>To use John the Ripper to crack a zip file, we first need to convert it to something that John the Ripper can understand.</p><p><code class="language-plaintext highlighter-rouge">zip2john cutie.zip &gt; cutie.hash</code> <code class="language-plaintext highlighter-rouge">john --wordlist=/usr/share/wordlists/rockyou.txt cutie.hash</code></p><h2 id="references">References</h2><div class="footnotes" role="doc-endnotes"><ol><li id="fn:sudo-exploit" role="doc-endnote"><p><a href="https://www.exploit-db.com/exploits/47502">https://www.exploit-db.com/exploits/47502</a> <a href="#fnref:sudo-exploit" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:sudo-exploit:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a></p></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/cybersecurity/'>Cybersecurity</a>, <a href='/categories/writeups/'>Writeups</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/thm/" class="post-tag no-text-decoration" >thm</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/burpsuite/" class="post-tag no-text-decoration" >burpsuite</a> <a href="/tags/user-agents/" class="post-tag no-text-decoration" >user-agents</a> <a href="/tags/web-application/" class="post-tag no-text-decoration" >web application</a> <a href="/tags/ftp/" class="post-tag no-text-decoration" >ftp</a> <a href="/tags/brute-force/" class="post-tag no-text-decoration" >brute force</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/steganography/" class="post-tag no-text-decoration" >steganography</a> <a href="/tags/steghide/" class="post-tag no-text-decoration" >steghide</a> <a href="/tags/base64/" class="post-tag no-text-decoration" >base64</a> <a href="/tags/7z2john/" class="post-tag no-text-decoration" >7z2john</a> <a href="/tags/jtr/" class="post-tag no-text-decoration" >jtr</a> <a href="/tags/password-cracking/" class="post-tag no-text-decoration" >password cracking</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Agent Sudo (Try Hack Me) - Robin Goyal&url=https://robgoyal.github.io/posts/thm-agent-sudo/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Agent Sudo (Try Hack Me) - Robin Goyal&u=https://robgoyal.github.io/posts/thm-agent-sudo/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://robgoyal.github.io/posts/thm-agent-sudo/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/configure-raspberry-pi-from-scratch/">Configure a Raspberry Pi from scratch</a><li><a href="/posts/pbs-rpi/">Proxmox Backup Server on Raspberry Pi</a><li><a href="/posts/thm-basic-pentesting/">Basic Pentesting (Try Hack Me)</a><li><a href="/posts/thm-gamezone/">Gamezone (Try Hack Me)</a><li><a href="/posts/thm-overpass/">Overpass (Try Hack Me)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/thm/">thm</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/web-application/">web application</a> <a class="post-tag" href="/tags/ejpt/">eJPT</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/reverse-shell/">reverse shell</a> <a class="post-tag" href="/tags/brute-force/">brute force</a> <a class="post-tag" href="/tags/ine/">INE</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/thm-b99/"><div class="card-body"> <span class="timeago small" >Sep 6, 2021<i class="unloaded">2021-09-06T19:45:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Brooklyn Nine Nine (Try Hack Me)</h3><div class="text-muted small"><p> I am currently in the process of completing these boxes on Try Hack Me again in an effort to document my experience, reinforce my knowledge of the topics, and improve my ability to concisely commun...</p></div></div></a></div><div class="card"> <a href="/posts/thm-simple-ctf/"><div class="card-body"> <span class="timeago small" >Aug 24, 2021<i class="unloaded">2021-08-24T11:30:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Simple CTF (Try Hack Me)</h3><div class="text-muted small"><p> I am currently in the process of completing these boxes on Try Hack Me again along in an effort to document my experience, reinforce my knowledge of the topics, and improve my ability to concisely ...</p></div></div></a></div><div class="card"> <a href="/posts/thm-root-me/"><div class="card-body"> <span class="timeago small" >Aug 25, 2021<i class="unloaded">2021-08-25T08:30:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>RootMe (Try Hack Me)</h3><div class="text-muted small"><p> I am currently in the process of completing these boxes on Try Hack Me again in an effort to document my experience, reinforce my knowledge of the topics, and improve my ability to concisely commun...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/thm-kenobi/" class="btn btn-outline-primary" prompt="Older"><p>Kenobi (Try Hack Me)</p></a> <a href="/posts/thm-pickle-rick/" class="btn btn-outline-primary" prompt="Newer"><p>Pickle Rick (Try Hack Me)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/robgoyal">Robin Goyal</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/thm/">thm</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/web-application/">web application</a> <a class="post-tag" href="/tags/ejpt/">eJPT</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/reverse-shell/">reverse shell</a> <a class="post-tag" href="/tags/brute-force/">brute force</a> <a class="post-tag" href="/tags/ine/">INE</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://robgoyal.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
